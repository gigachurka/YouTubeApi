<!DOCTYPE html>
@model YouTubeApi.ViewModels.RegisterViewModel
@{
	var currentYear = DateTime.Now.Year;
}

<div class="glass-bg">
	@if (ViewBag.Message != null)
	{
		<div class="alert alert-info" style="margin-bottom:18px; color:#d32f2f; text-align:center;">@ViewBag.Message</div>
	}
	<div class="tab-panel">
		<button id="tabRegister" type="button" class="tab-btn active" onclick="showTab('register')">Регистрация</button>
		<button id="tabLogin" type="button" class="tab-btn" onclick="redirectToLogin()">Вход</button>
	</div>

	<div style="display: flex; justify-content: flex-end; max-width: 420px; margin: 0 auto 10px auto;">
		<button id="themeToggleRegister" class="yt-button theme-btn" style="background: rgba(255,255,255,0.25); color: #d32f2f; border: 1px solid #d32f2f; font-size: 1.1rem; border-radius: 10px; padding: 8px 18px; margin-top: 10px; margin-bottom: 10px; transition: background 0.2s;">
			<i class="fas fa-moon"></i> Сменить тему
		</button>
	</div>

	<div id="registerForm">
		<form asp-action="Register" method="post">
			<div asp-validation-summary="ModelOnly" class="text-danger"></div>
			<div class="input-group">
				<label asp-for="Email"></label>
				<input asp-for="Email" placeholder="Введите email" />
				<span asp-validation-for="Email" class="text-danger"></span>
			</div>
			<div class="input-group">
				<label asp-for="Year">Год рождения</label>
				<div class="year-row">
					<input id="yearInput" name="Year" type="number" min="1911" max="@currentYear" value="" placeholder="Год" oninput="syncYearRange()" />
					<input id="yearRange" type="range" min="1911" max="@currentYear" value="2000" oninput="syncYearInput()" />
				</div>
				<span asp-validation-for="Year" class="text-danger"></span>
			</div>
			<div class="input-group">
				<label asp-for="Password"></label>
				<input asp-for="Password" type="password" placeholder="Пароль" />
				<span asp-validation-for="Password" class="text-danger"></span>
			</div>
			<div class="input-group">
				<label asp-for="PasswordConfirm"></label>
				<input asp-for="PasswordConfirm" type="password" placeholder="Повторите пароль" />
				<span asp-validation-for="PasswordConfirm" class="text-danger"></span>
			</div>
			<div class="input-group">
				<label asp-for="ChannelId"></label>
				<input asp-for="ChannelId" placeholder="ID канала (опционально)" />
				<span asp-validation-for="ChannelId" class="text-danger"></span>
			</div>
			<button type="submit" class="yt-button">Зарегистрироваться</button>
		</form>
	</div>
</div>

@section Scripts {
	@{
		await Html.RenderPartialAsync("_ValidationScriptsPartial");
	}
}

<style>
	body {
		min-height: 100vh;
		background: linear-gradient(135deg, #f5f6fa 0%, #e9ecef 100%);
		background-attachment: fixed;
	}

	.glass-bg {
		max-width: 420px;
		margin: 60px auto 0 auto;
		background: rgba(255, 255, 255, 0.28);
		border-radius: 18px;
		box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.10);
		backdrop-filter: blur(12px);
		-webkit-backdrop-filter: blur(12px);
		border: 1px solid rgba(220, 220, 220, 0.28);
		padding: 38px 32px 28px 32px;
		display: flex;
		flex-direction: column;
		align-items: stretch;
	}

	.tab-panel {
		display: flex;
		justify-content: center;
		gap: 20px;
		margin-bottom: 24px;
	}

	.tab-btn {
		background: none;
		border: none;
		font-size: 1.1rem;
		font-weight: 600;
		color: #444;
		padding: 8px 18px;
		border-radius: 8px 8px 0 0;
		cursor: pointer;
		transition: background 0.2s, color 0.2s;
	}

		.tab-btn.active {
			background: rgba(220,220,220,0.35);
			color: #222;
		}

	.input-group {
		display: flex;
		flex-direction: column;
		margin-bottom: 18px;
	}

	.input-group label {
		margin-bottom: 6px;
		color: #333;
		font-size: 1rem;
		font-weight: 500;
	}

	.input-group input[type="text"],
	.input-group input[type="email"],
	.input-group input[type="password"],
	.input-group input[type="number"] {
		padding: 12px 14px;
		border-radius: 10px;
		border: 1.5px solid rgba(200,200,200,0.35);
		background: rgba(255,255,255,0.45);
		font-size: 1rem;
		outline: none;
		transition: border 0.2s, box-shadow 0.2s;
		box-shadow: 0 1px 4px rgba(31,38,135,0.04);
	}

	.input-group input:focus {
		border: 1.5px solid #888;
		box-shadow: 0 2px 8px rgba(100,100,100,0.08);
	}

	.year-row {
		display: flex;
		align-items: center;
		gap: 12px;
	}

	.year-row input[type="number"] {
		width: 90px;
		min-width: 70px;
		margin-right: 8px;
	}

	.year-row input[type="range"] {
		flex: 1;
		accent-color: #888;
		height: 3px;
		margin-left: 8px;
	}

	.yt-button {
		background: #222;
		color: #fff;
		border: none;
		border-radius: 10px;
		padding: 13px 0;
		font-size: 1.08rem;
		font-weight: bold;
		margin-top: 10px;
		width: 100%;
		cursor: pointer;
		transition: background 0.2s, box-shadow 0.2s;
		box-shadow: 0 2px 8px rgba(31,38,135,0.08);
		letter-spacing: 0.5px;
	}

		.yt-button:hover {
			background: #444;
			box-shadow: 0 4px 16px rgba(31,38,135,0.13);
		}

	.text-danger {
		color: #dc3545;
		font-size: 0.95em;
		margin-bottom: 8px;
	}

	::placeholder {
		color: #bdbdbd;
		opacity: 1;
	}

	.dark-theme, .dark-theme body {
		background-color: #111 !important;
		color: #fff !important;
	}
	.dark-theme .glass-bg {
		background: #181818 !important;
		color: #fff !important;
		border: 1px solid #d32f2f !important;
	}
	.dark-theme .tab-btn {
		color: #fff !important;
		background: #181818 !important;
		border-bottom: 2px solid #d32f2f !important;
	}
	.dark-theme .tab-btn.active {
		background: #d32f2f !important;
		color: #fff !important;
	}
	.dark-theme .yt-button {
		background-color: #d32f2f !important;
		color: #fff !important;
		border: 1px solid #ff1744 !important;
	}
	.dark-theme .yt-button:hover {
		background-color: #ff1744 !important;
		color: #fff !important;
	}
	.dark-theme .input-group input[type="text"],
	.dark-theme .input-group input[type="email"],
	.dark-theme .input-group input[type="password"],
	.dark-theme .input-group input[type="number"] {
		background-color: #111 !important;
		color: #fff !important;
		border: 1px solid #d32f2f !important;
	}
	.dark-theme .input-group label {
		color: #ff1744 !important;
	}
	.dark-theme .text-danger {
		color: #ff1744 !important;
	}
</style>

<script>
	const minYear = 1911;
	const maxYear = new Date().getFullYear();
	const yearInput = document.getElementById('yearInput');
	const yearRange = document.getElementById('yearRange');
	function syncYearInput() {
		yearInput.value = yearRange.value;
	}
	function syncYearRange() {
		let val = parseInt(yearInput.value);
		if (isNaN(val) || val < minYear) val = minYear;
		if (val > maxYear) val = maxYear;
		yearInput.value = val;
		yearRange.value = val;
	}
	window.onload = function() {
		if (yearInput && yearRange) {
			yearInput.value = 2000;
			yearRange.value = 2000;
		}
	};
	function showTab(tab) {
		document.getElementById('registerForm').style.display = tab === 'register' ? '' : 'none';
		document.getElementById('tabRegister').classList.toggle('active', tab === 'register');
		document.getElementById('tabLogin').classList.toggle('active', tab === 'login');
	}
	function redirectToLogin() {
		window.location.href = '/Account/Login';
	}
	function setThemeClassRegister(dark) {
		if (dark) {
			document.body.classList.add('dark-theme');
			document.getElementById('themeToggleRegister').innerHTML = '<i class="fas fa-sun"></i> Светлая тема';
		} else {
			document.body.classList.remove('dark-theme');
			document.getElementById('themeToggleRegister').innerHTML = '<i class="fas fa-moon"></i> Ночная тема';
		}
		localStorage.setItem('theme', dark ? 'dark' : 'light');
	}
	document.getElementById('themeToggleRegister').onclick = function () {
		setThemeClassRegister(!document.body.classList.contains('dark-theme'));
	};
	window.onload = function () {
		if (localStorage.getItem('theme') === 'dark') setThemeClassRegister(true);
		else setThemeClassRegister(false);
	};
</script>